<?xml version="1.0" encoding="utf-8"?>
<!--
  Data extraction rules for Android 12+ (API 31+).

  PRIVACY-FIRST APPROACH: Only sync aesthetic/visual settings.
  User data, learning samples, and privacy-sensitive data stay on-device only.

  What IS backed up (cloud-backup):
  - Theme preferences (custom themes, Material You settings)
  - Layout appearance (margins, height, key radius, sublabel style)
  - Visual settings (opacity, brightness, font size)

  What is NOT backed up:
  - Custom dictionary (user_dictionary) - PII
  - Clipboard history database - PII
  - On-device learning samples (swipe_ml_data.db) - PII
  - Privacy settings and consent
  - Personalization/adaptation data
  - Performance stats and model metadata
  - Short swipe customizations
-->
<data-extraction-rules>
    <cloud-backup>
        <!-- Exclude all databases (clipboard history, ML training data) -->
        <exclude domain="database" path="." />

        <!-- Exclude privacy-sensitive SharedPreferences -->
        <exclude domain="sharedpref" path="user_dictionary.xml" />
        <exclude domain="sharedpref" path="privacy_settings.xml" />
        <exclude domain="sharedpref" path="swipe_ml_stats.xml" />
        <exclude domain="sharedpref" path="personalization_prefs.xml" />
        <exclude domain="sharedpref" path="personalization_engine_prefs.xml" />
        <exclude domain="sharedpref" path="user_adaptation_prefs.xml" />
        <exclude domain="sharedpref" path="user_vocabulary_prefs.xml" />
        <exclude domain="sharedpref" path="bigram_store.xml" />
        <exclude domain="sharedpref" path="neural_performance_stats.xml" />
        <exclude domain="sharedpref" path="neural_model_metadata.xml" />
        <exclude domain="sharedpref" path="model_version_history.xml" />

        <!-- Exclude files with user customizations (not aesthetic) -->
        <exclude domain="file" path="short_swipe_customizations.json" />

        <!-- Include only aesthetic SharedPreferences -->
        <include domain="sharedpref" path="custom_theme_prefs.xml" />
        <include domain="sharedpref" path="material_theme_prefs.xml" />
        <include domain="sharedpref" path="emoji_last_use.xml" />
    </cloud-backup>

    <!-- Device-to-device transfer: same rules as cloud backup -->
    <device-transfer>
        <exclude domain="database" path="." />
        <exclude domain="sharedpref" path="user_dictionary.xml" />
        <exclude domain="sharedpref" path="privacy_settings.xml" />
        <exclude domain="sharedpref" path="swipe_ml_stats.xml" />
        <exclude domain="sharedpref" path="personalization_prefs.xml" />
        <exclude domain="sharedpref" path="personalization_engine_prefs.xml" />
        <exclude domain="sharedpref" path="user_adaptation_prefs.xml" />
        <exclude domain="sharedpref" path="user_vocabulary_prefs.xml" />
        <exclude domain="sharedpref" path="bigram_store.xml" />
        <exclude domain="sharedpref" path="neural_performance_stats.xml" />
        <exclude domain="sharedpref" path="neural_model_metadata.xml" />
        <exclude domain="sharedpref" path="model_version_history.xml" />
        <exclude domain="file" path="short_swipe_customizations.json" />
        <include domain="sharedpref" path="custom_theme_prefs.xml" />
        <include domain="sharedpref" path="material_theme_prefs.xml" />
        <include domain="sharedpref" path="emoji_last_use.xml" />
    </device-transfer>
</data-extraction-rules>
