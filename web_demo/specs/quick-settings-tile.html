<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Settings Tile - CleverKeys Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'ck-purple': '#9b59b6',
                        'ck-purple-dark': '#6b21a8',
                        'ck-purple-light': '#c39bd3',
                        'ck-dark': '#0f0f1a',
                        'ck-surface': '#1a1a2e',
                        'ck-card': '#242438',
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-text {
            background: linear-gradient(135deg, #9b59b6 0%, #c39bd3 50%, #9b59b6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="bg-ck-dark text-gray-100 min-h-screen">
    <!-- Nav -->
    <nav class="sticky top-0 bg-ck-dark/95 backdrop-blur border-b border-gray-800 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="../" class="flex items-center gap-3">
                <img src="https://raw.githubusercontent.com/tribixbite/CleverKeys/main/res/mipmap-xxxhdpi/ic_launcher.png" alt="CleverKeys" class="w-8 h-8 rounded-lg">
                <span class="font-bold">CleverKeys</span>
            </a>
            <div class="flex gap-4">
                <a href="./" class="text-gray-400 hover:text-white transition-colors">All Specs</a>
                <a href="../" class="text-gray-400 hover:text-white transition-colors">Home</a>
            </div>
        </div>
    </nav>

    <!-- Breadcrumb -->
    <div class="container mx-auto px-6 py-4 pt-20">
        <div class="flex items-center gap-2 text-sm text-gray-500">
            <a href="../" class="hover:text-ck-purple">Home</a>
            <span>/</span>
            <a href="./" class="hover:text-ck-purple">Specs</a>
            <span>/</span>
            <span class="text-gray-300">Quick Settings Tile</span>
        </div>
    </div>

    <!-- Header -->
    <header class="container mx-auto px-6 pb-8">
        <div class="flex items-center gap-3 mb-4">
            <span class="px-3 py-1 text-sm rounded-full" style="background: #f39c1220; color: #f39c12">Settings</span>
            <span class="px-3 py-1 text-sm rounded-full bg-ck-card text-gray-400">v1.2.8</span>
        </div>
        <h1 class="text-4xl font-bold gradient-text mb-2">Quick Settings Tile</h1>
        <p class="text-xl text-gray-400">Android Quick Settings tile for keyboard switching</p>
    </header>

    <!-- Content -->
    <main class="container mx-auto px-6 pb-20">
        <div class="bg-ck-surface rounded-2xl p-8 max-w-4xl">
            <h1 class="text-3xl font-bold mb-6 gradient-text">Quick Settings Tile</h1>

<h2 class="text-2xl font-bold mt-8 mb-4 text-ck-purple">Overview</h2>

<p class="mb-4 text-gray-300">CleverKeys provides an Android Quick Settings tile that allows users to quickly access the keyboard switcher from the notification shade. Tapping the tile opens the system input method picker, providing a convenient way to switch between keyboards without navigating to system settings.</p>

<h2 class="text-2xl font-bold mt-8 mb-4 text-ck-purple">Key Files</h2>

<table class="w-full mb-4 border-collapse"><thead class="border-b border-gray-700"><tr><th class="px-4 py-2 text-left font-semibold text-ck-purple-light">File</th><th class="px-4 py-2 text-left font-semibold text-ck-purple-light">Class/Function</th><th class="px-4 py-2 text-left font-semibold text-ck-purple-light">Purpose</th></tr></thead><tbody><tr class="border-b border-gray-800"><td class="px-4 py-2 text-gray-300"><code class="bg-ck-dark px-1 rounded">src/main/kotlin/tribixbite/cleverkeys/KeyboardTileService.kt</code></td><td class="px-4 py-2 text-gray-300"><code class="bg-ck-dark px-1 rounded">KeyboardTileService</code></td><td class="px-4 py-2 text-gray-300">TileService implementation</td></tr><tr class="border-b border-gray-800"><td class="px-4 py-2 text-gray-300"><code class="bg-ck-dark px-1 rounded">AndroidManifest.xml</code></td><td class="px-4 py-2 text-gray-300">Service registration</td><td class="px-4 py-2 text-gray-300">Declares tile service</td></tr></tbody></table>
<h2 class="text-2xl font-bold mt-8 mb-4 text-ck-purple">Architecture</h2>

<pre class="bg-ck-dark p-4 rounded-lg overflow-x-auto"><code class="language-text">Quick Settings Panel
       |
       v (user taps tile)
+------------------+
| KeyboardTile     | -- Android calls onClick()
| Service          |
+------------------+
       |
       v
+------------------+
| showInputMethod  | -- Opens system IME picker
| Picker()         |
+------------------+
       |
       v (fallback)
+------------------+
| Open Input       | -- If picker fails, opens settings
| Method Settings  |
+------------------+</code></pre>

<h2 class="text-2xl font-bold mt-8 mb-4 text-ck-purple">Public API</h2>

<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">KeyboardTileService</h3>

<pre class="bg-ck-dark p-4 rounded-lg overflow-x-auto"><code class="language-kotlin">@RequiresApi(Build.VERSION_CODES.N)
class KeyboardTileService : TileService() {

    // Called when Quick Settings panel opens
    override fun onStartListening() {
        updateTileState()
    }

    // Called when user taps the tile
    override fun onClick() {
        showInputMethodPicker()
    }

    // Called when user adds tile to panel
    override fun onTileAdded() {
        updateTileState()
    }

    // Update tile visual state
    private fun updateTileState() {
        qsTile?.apply {
            state = if (isCleverKeysActive()) Tile.STATE_ACTIVE else Tile.STATE_INACTIVE
            updateTile()
        }
    }

    // Show system input method picker
    private fun showInputMethodPicker() {
        val imm = getSystemService(InputMethodManager::class.java)
        imm?.showInputMethodPicker()
    }
}</code></pre>

<h2 class="text-2xl font-bold mt-8 mb-4 text-ck-purple">Implementation Details</h2>

<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">Tile States</h3>

<table class="w-full mb-4 border-collapse"><thead class="border-b border-gray-700"><tr><th class="px-4 py-2 text-left font-semibold text-ck-purple-light">State</th><th class="px-4 py-2 text-left font-semibold text-ck-purple-light">Condition</th><th class="px-4 py-2 text-left font-semibold text-ck-purple-light">Visual</th></tr></thead><tbody><tr class="border-b border-gray-800"><td class="px-4 py-2 text-gray-300"><code class="bg-ck-dark px-1 rounded">STATE_ACTIVE</code></td><td class="px-4 py-2 text-gray-300">CleverKeys is current input method</td><td class="px-4 py-2 text-gray-300">Highlighted/colored</td></tr><tr class="border-b border-gray-800"><td class="px-4 py-2 text-gray-300"><code class="bg-ck-dark px-1 rounded">STATE_INACTIVE</code></td><td class="px-4 py-2 text-gray-300">Another keyboard is active</td><td class="px-4 py-2 text-gray-300">Dimmed/gray</td></tr></tbody></table>
<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">Input Method Detection</h3>

<pre class="bg-ck-dark p-4 rounded-lg overflow-x-auto"><code class="language-kotlin">private fun isCleverKeysActive(): Boolean {
    val currentIme = Settings.Secure.getString(
        contentResolver,
        Settings.Secure.DEFAULT_INPUT_METHOD
    )
    return currentIme?.contains(packageName) == true
}</code></pre>

<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">Fallback Behavior</h3>

<p class="mb-4 text-gray-300">If <code class="bg-ck-dark px-1 rounded">InputMethodManager.showInputMethodPicker()</code> fails:</p>

<pre class="bg-ck-dark p-4 rounded-lg overflow-x-auto"><code class="language-kotlin">private fun showInputMethodPicker() {
    try {
        val imm = getSystemService(InputMethodManager::class.java)
        imm?.showInputMethodPicker()
    } catch (e: Exception) {
        // Fallback: open system input method settings
        val intent = Intent(Settings.ACTION_INPUT_METHOD_SETTINGS)
        intent.flags = Intent.FLAG_ACTIVITY_NEW_TASK
        startActivity(intent)
    }
}</code></pre>

<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">AndroidManifest Registration</h3>

<pre class="bg-ck-dark p-4 rounded-lg overflow-x-auto"><code class="language-xml">&lt;service
    android:name="tribixbite.cleverkeys.KeyboardTileService"
    android:label="@string/app_name"
    android:icon="@mipmap/ic_launcher"
    android:permission="android.permission.BIND_QUICK_SETTINGS_TILE"
    android:exported="true"&gt;
  &lt;intent-filter&gt;
    &lt;action android:name="android.service.quicksettings.action.QS_TILE"/&gt;
  &lt;/intent-filter&gt;
&lt;/service&gt;</code></pre>

<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">Requirements</h3>

<ul class="mb-4 space-y-1"><li class="ml-4">&#8226; Android 7.0 (API 24) or higher (TileService introduced in API 24)</li>
<li class="ml-4">&#8226; CleverKeys must be installed and enabled as an input method</li>
<li class="ml-4">&#8226; User must manually add tile to Quick Settings panel</li>
</ul>
<h3 class="text-xl font-semibold mt-6 mb-3 text-ck-purple-light">User Flow</h3>

<ul class="mb-4 space-y-1"><li class="ml-4">1. Pull down notification shade</li>
<li class="ml-4">2. Tap "Edit" or pencil icon to customize tiles</li>
<li class="ml-4">3. Find "CleverKeys" in available tiles</li>
<li class="ml-4">4. Drag to active tiles area</li>
<li class="ml-4">5. Tile now appears in Quick Settings</li>
<li class="ml-4">6. Tap tile → system IME picker appears → select keyboard</li>
</ul>
        </div>
    </main>

    <!-- Footer -->
    <footer class="container mx-auto px-6 py-8 text-center text-gray-500 text-sm border-t border-gray-800">
        <p>CleverKeys Documentation - Generated from specs</p>
    </footer>
</body>
</html>